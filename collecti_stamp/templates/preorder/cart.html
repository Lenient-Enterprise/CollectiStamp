<!-- company/details.html -->
{% extends "base.html" %}

{% block title %}{{ company.name }} Carrito {% endblock %}

{% block content %}

<div class="alert alert-primary" role="alert">
    <table class="table table-bordered">
        <thead>
            <tr>
                <th scope="row" colspan="3" class="text-center">CARRITO</th>
            </tr>
            <tr>
                {% if request.session.cart.items %}
                    <th></th>
                    <th scope="col">Nombre</th>
                    <th scope="col">Precio</th>
                    <th scope="col">Cantidad</th>
                    <th scope="col" style="width: 75px;">Eliminar producto</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
        {% if request.session.cart %}
            {% if request.session.cart.items %}
                {% for key, value in request.session.cart.items %}
                    <tr>
                        <td>
                            {% if value.image %}                
                                <img src="{{ value.image }}" alt="{{ product.name }}" class="img-fluid img-thumbnail" style="max-width: 100px;">
                            {% endif %}
                        </td>
                        <td>{{value.name}}</td>
                        <td>{{value.price}}</td>
                        <td>
                            <a href="{% url 'decrement_product' value.product_id 1 %}" class="badge btn btn-dark badge-dark" style="font-size: 20px;">-</a>
                            {{value.amount}}
                            {% if not value.amount >= value.stock_amount %}
                                <a href="{% url 'add_product' value.product_id 1 %}" class="badge btn btn-dark badge-dark" style="font-size: 20px;">+</a>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{% url 'delete_product' value.product_id %}" class="badge btn btn-danger">Eliminar</a>
                        </td>
                    </tr>
                {% endfor %}
                <tr>
                    <th scope="row" class="text-center font-weight-bold">Total:</th>
                    <td colspan="2" class="text-center text-danger font-weight-bold">{{ total_cart }} â‚¬</td>
                </tr>
            {% endif %}
        {% else %}            
            <tr>
                <td colspan="3">
                    <div class="alert alert-danger text-center"> Sin Productos </div>
                </td>
            </tr>
        {% endif %}
        </tbody>
    </table>
    {% if request.session.cart.items %}
        <div class="row text-center">
            <div class="col-6"><a href="{% url 'delete_cart' %}" class="btn btn-danger">Limpiar carro</a></div>
            <div class="col-6">
                <form method="post" action="{% url 'finish_order' %}">
                    {% csrf_token %}
                    <input type="submit" value="Realizar pago" class="btn btn-success">
                </form>
            </div>
        </div>
    <hr>
    {% endif %}
</div>

{% endblock %}